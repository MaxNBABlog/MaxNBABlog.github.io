<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NBA Deep Dives with Max Krupp</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
    :root {
      --accent-gold: #c9b037;
      --accent-gold-dark: #a68a1d;
      --accent-gold-light: #f7e7a0;
      --main-bg: #f9f9f9;
      --main-font: #232323;
      --card-bg: #fff;
      --card-shadow: 0 8px 32px rgba(0,0,0,0.10);
    }
    body {
      margin: 0;
      font-family: 'Montserrat', Arial, sans-serif;
      background-color: var(--main-bg);
      color: var(--main-font);
      min-height: 100vh;
    }
    header {
      background-image: url('CeticsImage.jpg');
      background-size: cover;
      background-position: center;
      color: white;
      text-align: center;
      padding: 140px 10px;
      font-size: 2.5em;
      font-weight: bold;
      position: relative;
    }
    header::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
    header span {
      position: relative;
      z-index: 2;
    }
    header .nav-buttons {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 3;
      display: flex;
      gap: 10px;
    }
    header .nav-buttons a {
      text-decoration: none;
      color: white;
      font-size: 1em;
      font-weight: bold;
      border: 2px solid white;
      padding: 8px 16px;
      border-radius: 4px;
      display: inline-block;
      transition: color 0.3s, border-color 0.3s;
    }
    header .nav-buttons a:hover {
      color: var(--accent-gold);
      border-color: var(--accent-gold);
    }
    .container {
      display: flex;
      flex: 1;
      gap: 20px;
      padding: 20px;
    }
    .content {
      flex: 1;
      padding: 20px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--card-shadow);
      min-height: 300px;
    }
    .sidebar {
      width: 300px;
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .post-title {
      cursor: pointer;
      margin-bottom: 14px;
      color: var(--accent-gold);
      font-weight: bold;
      font-size: 1.1em;
      letter-spacing: 0.5px;
      padding: 8px 12px;
      border-radius: 6px;
      transition: color 0.3s, background 0.3s;
      position: relative;
    }
    .story-pro {
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: var(--card-shadow);
      padding: 48px 32px 32px 32px;
      margin-bottom: 32px;
      position: relative;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      font-family: 'Montserrat', Arial, sans-serif;
    }
    .story-pro h2 {
      text-align: center;
      font-size: 2.5em;
      color: var(--accent-gold);
      font-weight: 700;
      margin-bottom: 24px;
      letter-spacing: 1px;
    }
    .story-pro .story-image {
      display: block;
      margin: 0 auto 24px auto;
      max-width: 90%;
      max-height: 340px;
      border-radius: 14px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.10);
      object-fit: contain;
      background: #f7f7f7;
    }
    .circle-shadow {
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 0 0 4px var(--accent-gold), 0 4px 24px rgba(0,0,0,0.18);
    }
    .story-pro .meta {
      margin-bottom: 24px;
      margin-left: 0;
      text-align: left;
    }
    .story-pro .meta .date {
      font-size: 1em;
      color: #888;
      font-weight: 500;
      margin-bottom: 4px;
      display: block;
    }
    .story-pro .meta .author {
      font-size: 1em;
      color: #444;
      font-style: italic;
      font-weight: 500;
      margin-bottom: 0;
      display: block;
    }
    .story-pro .content {
      font-size: 1.18em;
      color: #232323;
      margin-bottom: 32px;
      line-height: 1.7;
      text-align: left;
      padding: 10px 0;
      font-family: 'Montserrat', Arial, sans-serif;
    }
    .divider {
      border: none;
      border-top: 2px solid #eee;
      margin: 24px 0 16px 0;
    }
    .comment-section {
      margin-top: 30px;
      padding: 20px;
      background: #fdf7e3;
      border: 1px solid #f7e7a0;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
      font-family: 'Montserrat', Arial, sans-serif;
    }
    .comment-section h3 {
      margin-bottom: 20px;
      font-size: 1.3em;
      color: var(--accent-gold);
      font-weight: 600;
    }
    .comment {
      margin-bottom: 18px;
      padding: 12px 16px;
      background: #fff;
      border: 1px solid #e3e3e3;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
      position: relative;
    }
    .comment p {
      margin: 0 0 6px 0;
      font-size: 1em;
      color: #333;
      display: inline;
    }
    .replyButton {
      margin-top: 5px;
      padding: 4px 12px;
      background: var(--accent-gold);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.95em;
      transition: background 0.3s;
    }
    .replyButton:hover {
      background: var(--accent-gold-dark);
    }
    .replies {
      margin-top: 10px;
      padding-left: 18px;
      border-left: 2px solid var(--accent-gold-light);
    }
    .replies p {
      font-style: italic;
      color: #555;
      margin: 5px 0;
      background: #fffbe6;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.97em;
    }
    select,
    input[type="text"],
    input[type="date"],
    textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
      font-family: inherit;
      font-size: 1em;
    }
    textarea {
      resize: none;
    }
    p {
      line-height: 1.6;
    }
    button {
      padding: 10px 20px;
      background: var(--accent-gold);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
      font-size: 1em;
    }
    button:hover {
      background: var(--accent-gold-dark);
    }
    @media (max-width: 900px) {
      .container { flex-direction: column; }
      .sidebar { width: 100%; margin-top: 20px; }
      .story-pro { padding: 24px 8px; }
      .editor-toolbar { flex-direction: column; }
      .editor-toolbar button { width: 100%; }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-buttons">
      <a href="index.html">Home</a>
      <a href="admin.html">Admin</a>
    </div>
    <span>NBA Deep Dives with Max Krupp</span>
  </header>
  <div class="container">
    <div class="content" id="postContent" style="text-align: center;">
      <h2>About Me</h2>
      <p>
        Hi, I'm Max Krupp, a Vermont native who's passionate about basketball. I plan to use this blog as an opportunity to share my knowledge of the sport and break down current events at both the professional and collegiate levels. I will discuss trade rumors, free agent signings, transfer portal announcements, player performance, and many other topics that I hope viewers find just as exciting to read as I do to write. Join me as we explore the stories, players, and teams 
        that make the game so exciting.
      </p>
    </div>
    <div class="sidebar">
      <select id="filterSortBar">
        <option value="newest">Newest to Oldest</option>
        <option value="oldest">Oldest to Newest</option>
      </select>
      <div id="postList"></div>
    </div>
  </div>

  <script>
    // Use localStorage to persist posts
    const STORAGE_KEY = 'nba_blog_posts';

    function loadPosts() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        try {
          return JSON.parse(saved);
        } catch {
          return [];
        }
      }
      return [];
    }

    let posts = loadPosts();

    function savePosts() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(posts));
    }

    const postList = document.getElementById('postList');
    const postContent = document.getElementById('postContent');
    const filterSortBar = document.getElementById('filterSortBar');

    filterSortBar.addEventListener('change', displayPosts);
    
    // Home button functionality - show About Me
    function showAboutMe() {
      postContent.innerHTML = `
        <h2>About Me</h2>
        <p>
          Hi, I'm Max Krupp, a Vermont native who's passionate about basketball. I plan to use this blog as an opportunity to share my knowledge of the sport and break down current events at both the professional and collegiate levels. I will discuss trade rumors, free agent signings, transfer portal announcements, player performance, and many other topics that I hope viewers find just as exciting to read as I do to write. Join me as we explore the stories, players, and teams 
          that make the game so exciting.
        </p>
      `;
    }

    function displayPosts() {
      const selectedOption = filterSortBar.value;
      let filteredPosts = posts.slice();
      
      if (selectedOption === "newest") {
        filteredPosts.sort((a, b) => new Date(b.date) - new Date(a.date));
      } else if (selectedOption === "oldest") {
        filteredPosts.sort((a, b) => new Date(a.date) - new Date(b.date));
      }
      
      postList.innerHTML = '';
      if (filteredPosts.length === 0) {
        postList.innerHTML = '<p style="color:#888;font-size:0.9em;">No posts yet. Check back soon!</p>';
        return;
      }
      
      filteredPosts.forEach((post, index) => {
        const div = document.createElement('div');
        div.className = 'post-title';
        div.innerHTML = `<span style="cursor:pointer;">${post.title}</span>`;
        div.querySelector('span').onclick = () => displayPostContent(index);
        postList.appendChild(div);
      });
    }

    // --- IMAGE HTML HELPERS WITH CIRCLE SHADOW SUPPORT ---
    function getImageHtml(post) {
      if (!post.image || post.imagePosition === 'none') return '';
      let sizeCss = '';
      if (post.imageSize === 'small') sizeCss = 'max-width:100px;';
      else if (post.imageSize === 'large') sizeCss = 'max-width:350px;';
      else sizeCss = 'max-width:200px;';
      let shapeClass = '';
      let shapeCss = '';
      if (post.imageShape === 'circle-shadow') {
        shapeClass = 'circle-shadow';
      } else if (post.imageShape === 'circle') {
        shapeCss = 'border-radius:50%;object-fit:cover;';
      } else if (post.imageShape === 'rounded') {
        shapeCss = 'border-radius:18px;';
      }
      let floatCss = '';
      if (post.imagePosition === 'left') floatCss = 'float:left;margin:0 1em 1em 0;';
      else if (post.imagePosition === 'right') floatCss = 'float:right;margin:0 0 1em 1em;';
      else floatCss = 'display:block;margin:0 auto 24px auto;';
      return `<img src="${post.image}" class="${shapeClass}" style="${sizeCss}${shapeCss}${floatCss}" alt="Main Image" />`;
    }


    function displayPostContent(index) {
      const post = posts[index];
      let imageHtml = getImageHtml(post);
      let contentHtml = post.content || '';
      
      // Handle legacy posts with paragraphs structure
      if (post.paragraphs && post.paragraphs.length && !post.content) {
        contentHtml = post.paragraphs.map(p => `<p>${p.text || ''}</p>`).join('');
      }
      
      if (post.image && post.imagePosition === 'left') {
        contentHtml = `<div>${imageHtml}<div style="overflow:hidden;">${contentHtml}</div></div>`;
      } else if (post.image && post.imagePosition === 'right') {
        contentHtml = `<div>${imageHtml}<div style="overflow:hidden;">${contentHtml}</div></div>`;
      } else if (post.image && post.imagePosition === 'top') {
        contentHtml = `${imageHtml}${contentHtml}`;
      }
      
      postContent.innerHTML = `
        <div class="story-pro">
          <h2>${post.title}</h2>
          <div class="meta">
            <span class="date">${post.date}</span>
            <span class="author">By Max Krupp</span>
          </div>
          <div class="content">${contentHtml}</div>
          <hr class="divider" />
          <div class="comment-section">
            <h3>Comments</h3>
            <div id="commentsSection"></div>
            <textarea id="commentInput" placeholder="Write a comment..." style="width: 100%; margin-bottom: 10px;"></textarea>
            <button id="addCommentButton">Add Comment</button>
          </div>
        </div>
      `;

      const commentsSection = document.getElementById('commentsSection');
      (post.comments || []).forEach((comment, commentIndex) => {
        const commentDiv = document.createElement('div');
        commentDiv.className = 'comment';
        commentDiv.innerHTML = `
          <p>${comment.text}</p>
          <button class="replyButton" data-index="${commentIndex}">Reply (Admin Only)</button>
          <div class="replies">
            ${(comment.replies || []).map(reply => `<p>${reply}</p>`).join('')}
          </div>
          <div id="replyInputContainer-${commentIndex}" style="display:none;margin-top:5px;">
            <input type="text" id="replyInput-${commentIndex}" placeholder="Your reply as Max Krupp..." style="width:80%;" />
            <button onclick="submitReply(${index},${commentIndex})">Send</button>
          </div>
        `;
        commentsSection.appendChild(commentDiv);
      });

      document.querySelectorAll('.replyButton').forEach(btn => {
        btn.addEventListener('click', function() {
          const idx = this.getAttribute('data-index');
          document.getElementById(`replyInputContainer-${idx}`).style.display = 'block';
        });
      });

      document.getElementById('addCommentButton').onclick = () => {
        const commentText = document.getElementById('commentInput').value;
        if (commentText.trim()) {
          if (!post.comments) post.comments = [];
          post.comments.push({ text: commentText, replies: [] });
          savePosts();
          displayPostContent(index);
        }
      };
    }

    window.submitReply = function(postIndex, commentIndex) {
      const replyInput = document.getElementById(`replyInput-${commentIndex}`);
      const replyText = replyInput.value.trim();
      if (replyText) {
        posts[postIndex].comments[commentIndex].replies = posts[postIndex].comments[commentIndex].replies || [];
        posts[postIndex].comments[commentIndex].replies.push(`Max Krupp: ${replyText}`);
        savePosts();
        displayPostContent(postIndex);
      }
    };

    // Initial display
    showAboutMe();
    displayPosts();
  </script>
</body>
</html>